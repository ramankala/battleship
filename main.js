(()=>{"use strict";const e=e=>{const t=[];return{ship:t,length:e,hit:e=>t[e]="hit",isSunk:()=>{let r=0,i=!1;return t.forEach((function(e){"hit"===e&&(r+=1)})),i=r===e,i}}},t=(t,r=!1)=>{let i=e(5),a=e(4),o=e(3),n=e(3),l=e(2),d={name:t,isActive:r};return{get name(){return d.name},get isActive(){return d.isActive},toggle(){d.isActive=!d.isActive},board:(()=>{let e=[["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""],["","","","","","","","","",""]];for(let t=0;t<10;t++)for(let r=0;r<10;r++)e[t][r]={hasShip:!1,isShot:!1,shipLength:0,shipType:"n/a",xPoint:0,yPoint:0};return{gameBoard:e,placeShip:(t,r,i,a)=>{for(let o=0;o<i;o++)e[t][r].hasShip=!0,console.log("hasShip works"),e[t][r].shipLength=i,console.log("shipLength works"),e[t][r].shipType=a,console.log("shipType works"),e[t][r].xPoint=t,console.log("xPoint works"),e[t][r].yPoint=r,console.log("yPoint works"),r+=1;return e},receiveAttack:(t,r)=>!0===e[t][r].hasShip?(e[t][r].isShot=!0,"Hit"):(e[t][r].isShot=!0,e),allShipsSunk:e=>e.filter((e=>e.isSunk())).length===e.length}})(),ships:[i,a,o,n,l],enemyMove:()=>[Math.floor(10*Math.random()),Math.floor(10*Math.random())]}},r=(e,t)=>{let r=document.querySelector(`#container${t}`),i=document.createElement("div");i.setAttribute("id","row1");let a=document.createElement("div");a.setAttribute("id","row2");let o=document.createElement("div");o.setAttribute("id","row3");let n=document.createElement("div");n.setAttribute("id","row4");let l=document.createElement("div");l.setAttribute("id","row5");let d=document.createElement("div");d.setAttribute("id","row6");let s=document.createElement("div");s.setAttribute("id","row7");let h=document.createElement("div");h.setAttribute("id","row8");let u=document.createElement("div");u.setAttribute("id","row9");let c=document.createElement("div");c.setAttribute("id","row10"),e.forEach((function(e,p){e.forEach((function(e,g){let m=document.createElement("div");m.setAttribute("id",`squareDiv${p}${g}`),m.setAttribute("data-y-coord",g),m.setAttribute("data-x-coord",p),m.setAttribute("data-has-ship",e.hasShip),m.setAttribute("data-is-shot",e.isShot),m.classList.add(`atkDiv${t}`),m.textContent=e.hasShip;for(let e=0;e<10;e++)m.getAttribute("id")==`squareDiv0${e}`?i.appendChild(m):m.getAttribute("id")==`squareDiv1${e}`?a.appendChild(m):m.getAttribute("id")==`squareDiv2${e}`?o.appendChild(m):m.getAttribute("id")==`squareDiv3${e}`?n.appendChild(m):m.getAttribute("id")==`squareDiv4${e}`?l.appendChild(m):m.getAttribute("id")==`squareDiv5${e}`?d.appendChild(m):m.getAttribute("id")==`squareDiv6${e}`?s.appendChild(m):m.getAttribute("id")==`squareDiv7${e}`?h.appendChild(m):m.getAttribute("id")==`squareDiv8${e}`?u.appendChild(m):m.getAttribute("id")==`squareDiv9${e}`&&c.appendChild(m);r.appendChild(i),r.appendChild(a),r.appendChild(o),r.appendChild(n),r.appendChild(l),r.appendChild(d),r.appendChild(s),r.appendChild(h),r.appendChild(u),r.appendChild(c)}))}))},i=(e,t,r)=>{let i,o,n,l,d,s=t.board,h=t.ships,u=document.getElementsByClassName(`atkDiv${r}`),c=0,p=0,g=0,m=0,v=0;for(let r=0;r<u.length;r++)u[r].addEventListener("click",(function(r){if(!0===e.isActive&&(o=r.target.getAttribute("data-y-coord"),n=r.target.getAttribute("data-x-coord"),i=s.gameBoard[n][o].isShot,l=s.gameBoard[n][o].shipLength,d=s.gameBoard[n][o].shipType,!1===i)){if("true"===r.target.getAttribute("data-has-ship")?r.target.style.backgroundColor="red":r.target.style.backgroundColor="grey",console.log(n),console.log(o),s.receiveAttack(n,o),!0===s.allShipsSunk(h))return void console.log("Player won!");if(!0===e.board.allShipsSunk(e.ships))return void console.log("Computer won!");"Carrier"==d?(h.filter((e=>e.length==l))[0].hit(c),c+=1):"Battleship"==d?(h.filter((e=>e.length==l))[0].hit(p),p+=1):"Destroyer"==d?(h.filter((e=>e.length==l))[0].hit(g),g+=1):"Submarine"==d?(h.filter((e=>e.length==l))[1].hit(m),m+=1):"Patrolboat"==d&&(h.filter((e=>e.length==l))[0].hit(v),v+=1),e.toggle(),t.toggle();let i=e.enemyMove();console.log(i),a(e,t,i[0],i[1])}}))},a=(e,t,r,i)=>{let o,n=e.board,l=e.ships,d=n.gameBoard[r][i].isShot,s=n.gameBoard[r][i].hasShip,h=n.gameBoard[r][i].shipLength,u=n.gameBoard[r][i].shipType;o=0===r?i:""+r+i;let c=document.getElementsByClassName("atkDiv1")[o],p=0,g=0,m=0,v=0,b=0;if(!0===t.isActive)if(!1===d){if(c.style.backgroundColor=!0===s?"red":"grey",n.receiveAttack(r,i),!0===n.allShipsSunk(l))return void console.log("Computer won!");if(!0===t.board.allShipsSunk(t.ships))return void console.log("User won!");"Carrier"==u?(l.filter((e=>e.length==h))[0].hit(p),p+=1):"Battleship"==u?(l.filter((e=>e.length==h))[0].hit(g),g+=1):"Destroyer"==u?(l.filter((e=>e.length==h))[0].hit(m),m+=1):"Submarine"==u?(l.filter((e=>e.length==h))[1].hit(v),v+=1):"Patrolboat"==u&&(l.filter((e=>e.length==h))[0].hit(b),b+=1),e.toggle(),t.toggle()}else{let r=e.enemyMove();a(e,t,r[0],r[1])}};(()=>{const e=document.querySelector("#startBtn"),a=e=>{e.dataTransfer.setData("text/plain",e.target.id),e.currentTarget.style.backgroundColor="green"};document.querySelector("#Carrier").addEventListener("dragstart",a),document.querySelector("#Battleship").addEventListener("dragstart",a),document.querySelector("#Destroyer").addEventListener("dragstart",a),document.querySelector("#Submarine").addEventListener("dragstart",a),document.querySelector("#PatrolBoat").addEventListener("dragstart",a);const o=[t("player1",!0),t("computer",!1)];r(o[0].board.gameBoard,1),(e=>{const t=e=>{e.preventDefault()},r=t=>{t.preventDefault(),t.target.style.backgroundColor="green",console.log(t.target.getAttribute("data-y-coord")),console.log(t.target.getAttribute("data-x-coord"));let r=t.target.getAttribute("data-x-coord"),i=t.target.getAttribute("data-y-coord"),a=t.dataTransfer.getData("text");console.log(e),"Carrier"===a&&e.placeShip(parseInt(r),parseInt(i),5,a),"Battleship"===a&&e.placeShip(parseInt(r),parseInt(i),4,a),"Destroyer"===a&&e.placeShip(parseInt(r),parseInt(i),3,a),"Submarine"===a&&e.placeShip(parseInt(r),parseInt(i),3,a),"PatrolBoat"===a&&e.placeShip(parseInt(r),parseInt(i),2,a)};let i=document.getElementsByClassName("atkDiv1");for(let e=0;e<i.length;e++)i[e].addEventListener("dragover",t),i[e].addEventListener("drop",r)})(o[0].board),e.addEventListener("click",(function(){(()=>{let e=document.querySelector("#container1");for(;e.firstChild;)e.removeChild(e.firstChild)})(),console.log(o[0].board.gameBoard),r(o[0].board.gameBoard,1),r(o[1].board.gameBoard,2),i(o[0],o[1],2),i(o[1],o[0],2)}))})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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MkQsaUJBQWlCLE9BQVFpQixJQ3JPekNJLENBQVlQLEVBQVUsR0FBRzNFLE9BRXpCcUUsRUFBU1IsaUJBQWlCLFNBQVMsV0R3T3RCLE1BQ2IsSUFBSXNCLEVBQVN2RCxTQUFTQyxjQUFjLGVBQ3BDLEtBQU9zRCxFQUFPQyxZQUNWRCxFQUFPRSxZQUFZRixFQUFPQyxhQzFPMUJFLEdBUUF6RSxRQUFRQyxJQUFJNkQsRUFBVSxHQUFHM0UsTUFBTUMsV0FDL0J3QixFQUFha0QsRUFBVSxHQUFHM0UsTUFBTUMsVUFBVyxHQU8zQ3dCLEVBQWFrRCxFQUFVLEdBQUczRSxNQUFNQyxVQUFXLEdBQzNDa0QsRUFBWXdCLEVBQVUsR0FBSUEsRUFBVSxHQUFJLEdBQ3hDeEIsRUFBWXdCLEVBQVUsR0FBSUEsRUFBVSxHQUFJLE9DeERoRFksSSIsInNvdXJjZXMiOlsid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvZ2FtZUJvYXJkRmFjdG9yeS5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3NoaXBGYWN0b3J5LmpzIiwid2VicGFjazovL2JhdHRsZXNoaXAvLi9zcmMvcGxheWVyRmFjdG9yeS5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL3JlbmRlci5qcyIsIndlYnBhY2s6Ly9iYXR0bGVzaGlwLy4vc3JjL2dhbWUuanMiLCJ3ZWJwYWNrOi8vYmF0dGxlc2hpcC8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzaGlwRmFjdG9yeSB9IGZyb20gJy4vc2hpcEZhY3RvcnknO1xuXG5jb25zdCBnYW1lQm9hcmRGYWN0b3J5ID0gKCkgPT4ge1xuICAgIGxldCBnYW1lQm9hcmQgPSBbXG4gICAgICAgIChbXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIl0pLFxuICAgICAgICAoW1wiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCJdKSxcbiAgICAgICAgKFtcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiXSksXG4gICAgICAgIChbXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIl0pLFxuICAgICAgICAoW1wiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCJdKSxcbiAgICAgICAgKFtcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiXSksXG4gICAgICAgIChbXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIl0pLFxuICAgICAgICAoW1wiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCIsIFwiXCJdKSxcbiAgICAgICAgKFtcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiLCBcIlwiXSksXG4gICAgICAgIChbXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIiwgXCJcIl0pLFxuICAgIF07XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKXtcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaisrKXtcbiAgICAgICAgICAgIGdhbWVCb2FyZFtpXVtqXSA9ICh7aGFzU2hpcDogZmFsc2UsIGlzU2hvdDogZmFsc2UsIHNoaXBMZW5ndGg6IDAsIHNoaXBUeXBlOiAnbi9hJywgeFBvaW50OiAwLCB5UG9pbnQ6IDB9KTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG5cbiAgICBjb25zdCBwbGFjZVNoaXAgPSAoeCwgeSwgc2hpcExlbmd0aCwgc2hpcFR5cGUpID0+IHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaGlwTGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgZ2FtZUJvYXJkW3hdW3ldLmhhc1NoaXAgPSB0cnVlO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2hhc1NoaXAgd29ya3MnKTtcbiAgICAgICAgICAgIGdhbWVCb2FyZFt4XVt5XS5zaGlwTGVuZ3RoID0gc2hpcExlbmd0aDtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzaGlwTGVuZ3RoIHdvcmtzJyk7XG4gICAgICAgICAgICBnYW1lQm9hcmRbeF1beV0uc2hpcFR5cGUgPSBzaGlwVHlwZTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzaGlwVHlwZSB3b3JrcycpO1xuICAgICAgICAgICAgZ2FtZUJvYXJkW3hdW3ldLnhQb2ludCA9IHg7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygneFBvaW50IHdvcmtzJyk7XG4gICAgICAgICAgICBnYW1lQm9hcmRbeF1beV0ueVBvaW50ID0geTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd5UG9pbnQgd29ya3MnKTtcbiAgICAgICAgICAgIHkgKz0gMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZ2FtZUJvYXJkO1xuICAgIH1cblxuICAgIGNvbnN0IHJlY2VpdmVBdHRhY2sgPSAoeCwgeSkgPT4ge1xuICAgICAgICBpZiAoZ2FtZUJvYXJkW3hdW3ldLmhhc1NoaXAgPT09IHRydWUpe1xuICAgICAgICAgICAgZ2FtZUJvYXJkW3hdW3ldLmlzU2hvdCA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm4gJ0hpdCc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBnYW1lQm9hcmRbeF1beV0uaXNTaG90ID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiBnYW1lQm9hcmQ7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgY29uc3QgYWxsU2hpcHNTdW5rID0gKGFycikgPT4ge1xuICAgICAgICBjb25zdCBzdW5rZW5TaGlwcyA9IGFyci5maWx0ZXIoc2hpcHMgPT4gc2hpcHMuaXNTdW5rKCkpO1xuICAgICAgICBpZiAoc3Vua2VuU2hpcHMubGVuZ3RoID09PSBhcnIubGVuZ3RoKXtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBnYW1lQm9hcmQsXG4gICAgICAgIHBsYWNlU2hpcCxcbiAgICAgICAgcmVjZWl2ZUF0dGFjayxcbiAgICAgICAgYWxsU2hpcHNTdW5rLFxuICAgIH1cbn07XG5cbmV4cG9ydCB7IGdhbWVCb2FyZEZhY3RvcnkgfTsiLCJcbmNvbnN0IHNoaXBGYWN0b3J5ID0gKGxlbmd0aCkgPT4ge1xuICAgIGNvbnN0IHNoaXAgPSBbXTtcblxuICAgIGNvbnN0IGhpdCA9IChwb3MpID0+IHNoaXBbcG9zXSA9ICdoaXQnO1xuXG4gICAgY29uc3QgaXNTdW5rID0gKCkgPT4ge1xuICAgICAgICBsZXQgY291bnQgPSAwO1xuICAgICAgICBsZXQgc3VuayA9IGZhbHNlO1xuXG4gICAgICAgIHNoaXAuZm9yRWFjaChmdW5jdGlvbihpdGVtKXtcbiAgICAgICAgICAgIGlmIChpdGVtID09PSAnaGl0Jyl7XG4gICAgICAgICAgICAgICAgY291bnQgKz0gMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChjb3VudCA9PT0gbGVuZ3RoKSB7XG4gICAgICAgICAgICBzdW5rID0gdHJ1ZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHN1bmsgPSBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzdW5rO1xuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBzaGlwLFxuICAgICAgICBsZW5ndGgsXG4gICAgICAgIGhpdCxcbiAgICAgICAgaXNTdW5rLFxuICAgIH1cbn07XG5cbmV4cG9ydCB7IHNoaXBGYWN0b3J5IH07IiwiaW1wb3J0IHsgZ2FtZUJvYXJkRmFjdG9yeSB9IGZyb20gJy4vZ2FtZUJvYXJkRmFjdG9yeSc7XG5pbXBvcnQgeyBzaGlwRmFjdG9yeSB9IGZyb20gJy4vc2hpcEZhY3RvcnknO1xuXG5jb25zdCBQbGF5ZXIgPSAobmFtZSwgaXNBY3RpdmUgPSBmYWxzZSkgPT4ge1xuXG4gICAgbGV0IGNhcnJpZXIgPSBzaGlwRmFjdG9yeSg1KTtcbiAgICBsZXQgYmF0dGxlc2hpcCA9IHNoaXBGYWN0b3J5KDQpO1xuICAgIGxldCBkZXN0cm95ZXIgPSBzaGlwRmFjdG9yeSgzKTtcbiAgICBsZXQgc3VibWFyaW5lID0gc2hpcEZhY3RvcnkoMyk7XG4gICAgbGV0IHBhdHJvbEJvYXQgPSBzaGlwRmFjdG9yeSgyKTtcbiAgICBcbiAgICBsZXQgc3RhdGUgPSB7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGlzQWN0aXZlLFxuICAgIH1cblxuICAgIGxldCBib2FyZCA9IGdhbWVCb2FyZEZhY3RvcnkoKTtcblxuICAgIGxldCBzaGlwcyA9IFtjYXJyaWVyLCBiYXR0bGVzaGlwLCBkZXN0cm95ZXIsIHN1Ym1hcmluZSwgcGF0cm9sQm9hdF07XG5cbiAgICBjb25zdCBlbmVteU1vdmUgPSAoKSA9PiB7XG4gICAgICAgIGxldCB4ID0gTWF0aC5mbG9vcigoTWF0aC5yYW5kb20oKSAqIDEwKSk7XG4gICAgICAgIGxldCB5ID0gTWF0aC5mbG9vcigoTWF0aC5yYW5kb20oKSAqIDEwKSk7XG5cbiAgICAgICAgcmV0dXJuIFt4LCB5XTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBnZXQgbmFtZSgpe3JldHVybiBzdGF0ZS5uYW1lO30sXG4gICAgICAgIGdldCBpc0FjdGl2ZSgpe3JldHVybiBzdGF0ZS5pc0FjdGl2ZTt9LFxuICAgICAgICB0b2dnbGUoKXsgc3RhdGUuaXNBY3RpdmUgPSAhc3RhdGUuaXNBY3RpdmU7fSxcbiAgICAgICAgYm9hcmQsXG4gICAgICAgIHNoaXBzLFxuICAgICAgICBlbmVteU1vdmUsXG4gICAgfVxufTtcblxuZXhwb3J0IHsgUGxheWVyIH07IiwiY29uc3QgcmVuZGVyR0JvYXJkID0gKGdhbWVCb2FyZCwgbnVtKSA9PiB7XG4gICAgbGV0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCNjb250YWluZXIke251bX1gKTtcbiAgICBsZXQgcm93MSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHJvdzEuc2V0QXR0cmlidXRlKCdpZCcsICdyb3cxJyk7XG4gICAgbGV0IHJvdzIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICByb3cyLnNldEF0dHJpYnV0ZSgnaWQnLCAncm93MicpO1xuICAgIGxldCByb3czID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgcm93My5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3JvdzMnKTtcbiAgICBsZXQgcm93NCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHJvdzQuc2V0QXR0cmlidXRlKCdpZCcsICdyb3c0Jyk7XG4gICAgbGV0IHJvdzUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICByb3c1LnNldEF0dHJpYnV0ZSgnaWQnLCAncm93NScpO1xuICAgIGxldCByb3c2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgcm93Ni5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3JvdzYnKTtcbiAgICBsZXQgcm93NyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHJvdzcuc2V0QXR0cmlidXRlKCdpZCcsICdyb3c3Jyk7XG4gICAgbGV0IHJvdzggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICByb3c4LnNldEF0dHJpYnV0ZSgnaWQnLCAncm93OCcpO1xuICAgIGxldCByb3c5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgcm93OS5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3JvdzknKTtcbiAgICBsZXQgcm93MTAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICByb3cxMC5zZXRBdHRyaWJ1dGUoJ2lkJywgJ3JvdzEwJyk7XG5cbiAgICBnYW1lQm9hcmQuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpbmRleCkge1xuICAgICAgICBpdGVtLmZvckVhY2goZnVuY3Rpb24oc3ViaXRlbSwgc3ViaW5kZXgpIHtcbiAgICAgICAgICAgIGxldCBzcXVhcmVEaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIHNxdWFyZURpdi5zZXRBdHRyaWJ1dGUoJ2lkJywgYHNxdWFyZURpdiR7aW5kZXh9JHtzdWJpbmRleH1gKTtcbiAgICAgICAgICAgIHNxdWFyZURpdi5zZXRBdHRyaWJ1dGUoJ2RhdGEteS1jb29yZCcsIHN1YmluZGV4KTtcbiAgICAgICAgICAgIHNxdWFyZURpdi5zZXRBdHRyaWJ1dGUoJ2RhdGEteC1jb29yZCcsIGluZGV4KTtcbiAgICAgICAgICAgIHNxdWFyZURpdi5zZXRBdHRyaWJ1dGUoJ2RhdGEtaGFzLXNoaXAnLCBzdWJpdGVtLmhhc1NoaXApO1xuICAgICAgICAgICAgc3F1YXJlRGl2LnNldEF0dHJpYnV0ZSgnZGF0YS1pcy1zaG90Jywgc3ViaXRlbS5pc1Nob3QpO1xuICAgICAgICAgICAgc3F1YXJlRGl2LmNsYXNzTGlzdC5hZGQoYGF0a0RpdiR7bnVtfWApO1xuICAgICAgICAgICAgc3F1YXJlRGl2LnRleHRDb250ZW50ID0gc3ViaXRlbS5oYXNTaGlwO1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKXtcbiAgICAgICAgICAgICAgICBpZiAoc3F1YXJlRGl2LmdldEF0dHJpYnV0ZSgnaWQnKSA9PSBgc3F1YXJlRGl2MCR7aX1gKXtcbiAgICAgICAgICAgICAgICAgICAgcm93MS5hcHBlbmRDaGlsZChzcXVhcmVEaXYpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3F1YXJlRGl2LmdldEF0dHJpYnV0ZSgnaWQnKSA9PSBgc3F1YXJlRGl2MSR7aX1gKXtcbiAgICAgICAgICAgICAgICAgICAgcm93Mi5hcHBlbmRDaGlsZChzcXVhcmVEaXYpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3F1YXJlRGl2LmdldEF0dHJpYnV0ZSgnaWQnKSA9PSBgc3F1YXJlRGl2MiR7aX1gKXtcbiAgICAgICAgICAgICAgICAgICAgcm93My5hcHBlbmRDaGlsZChzcXVhcmVEaXYpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3F1YXJlRGl2LmdldEF0dHJpYnV0ZSgnaWQnKSA9PSBgc3F1YXJlRGl2MyR7aX1gKXtcbiAgICAgICAgICAgICAgICAgICAgcm93NC5hcHBlbmRDaGlsZChzcXVhcmVEaXYpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3F1YXJlRGl2LmdldEF0dHJpYnV0ZSgnaWQnKSA9PSBgc3F1YXJlRGl2NCR7aX1gKXtcbiAgICAgICAgICAgICAgICAgICAgcm93NS5hcHBlbmRDaGlsZChzcXVhcmVEaXYpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3F1YXJlRGl2LmdldEF0dHJpYnV0ZSgnaWQnKSA9PSBgc3F1YXJlRGl2NSR7aX1gKXtcbiAgICAgICAgICAgICAgICAgICAgcm93Ni5hcHBlbmRDaGlsZChzcXVhcmVEaXYpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3F1YXJlRGl2LmdldEF0dHJpYnV0ZSgnaWQnKSA9PSBgc3F1YXJlRGl2NiR7aX1gKXtcbiAgICAgICAgICAgICAgICAgICAgcm93Ny5hcHBlbmRDaGlsZChzcXVhcmVEaXYpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3F1YXJlRGl2LmdldEF0dHJpYnV0ZSgnaWQnKSA9PSBgc3F1YXJlRGl2NyR7aX1gKXtcbiAgICAgICAgICAgICAgICAgICAgcm93OC5hcHBlbmRDaGlsZChzcXVhcmVEaXYpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3F1YXJlRGl2LmdldEF0dHJpYnV0ZSgnaWQnKSA9PSBgc3F1YXJlRGl2OCR7aX1gKXtcbiAgICAgICAgICAgICAgICAgICAgcm93OS5hcHBlbmRDaGlsZChzcXVhcmVEaXYpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc3F1YXJlRGl2LmdldEF0dHJpYnV0ZSgnaWQnKSA9PSBgc3F1YXJlRGl2OSR7aX1gKXtcbiAgICAgICAgICAgICAgICAgICAgcm93MTAuYXBwZW5kQ2hpbGQoc3F1YXJlRGl2KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocm93MSk7XG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocm93Mik7XG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocm93Myk7XG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocm93NCk7XG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocm93NSk7XG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocm93Nik7XG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocm93Nyk7XG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocm93OCk7XG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocm93OSk7XG4gICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocm93MTApO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn07XG5cbmNvbnN0IGF0a0xpc3RlbmVyID0gKHBsYXllciwgZW5lbXksIG51bSkgPT4ge1xuICAgIGxldCBnYW1lQm9hcmQgPSBlbmVteS5ib2FyZDtcbiAgICBsZXQgc2hpcHMgPSBlbmVteS5zaGlwcztcbiAgICBsZXQgcmVzcG9uc2UgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGBhdGtEaXYke251bX1gKTtcbiAgICBsZXQgaXNTaG90O1xuICAgIGxldCB5UG9pbnQ7XG4gICAgbGV0IHhQb2ludDtcbiAgICBsZXQgc2hpcExlbmd0aDtcbiAgICBsZXQgc2hpcFR5cGU7XG4gICAgbGV0IHBvczUgPSAwO1xuICAgIGxldCBwb3M0ID0gMDtcbiAgICBsZXQgcG9zMyA9IDA7XG4gICAgbGV0IHBvczIgPSAwO1xuICAgIGxldCBwb3MxID0gMDtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzcG9uc2UubGVuZ3RoOyBpKyspe1xuICAgICAgICByZXNwb25zZVtpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblxuICAgICAgICAgICAgaWYgKHBsYXllci5pc0FjdGl2ZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHlQb2ludCA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSgnZGF0YS15LWNvb3JkJyk7XG4gICAgICAgICAgICAgICAgeFBvaW50ID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLXgtY29vcmQnKTtcbiAgICAgICAgICAgICAgICBpc1Nob3QgPSBnYW1lQm9hcmQuZ2FtZUJvYXJkW3hQb2ludF1beVBvaW50XS5pc1Nob3Q7XG4gICAgICAgICAgICAgICAgc2hpcExlbmd0aCA9IGdhbWVCb2FyZC5nYW1lQm9hcmRbeFBvaW50XVt5UG9pbnRdLnNoaXBMZW5ndGg7XG4gICAgICAgICAgICAgICAgc2hpcFR5cGUgPSBnYW1lQm9hcmQuZ2FtZUJvYXJkW3hQb2ludF1beVBvaW50XS5zaGlwVHlwZTtcblxuICAgICAgICAgICAgICAgIGlmIChpc1Nob3QgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaGFzLXNoaXAnKSA9PT0gJ3RydWUnKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGUudGFyZ2V0LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdyZWQnO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZS50YXJnZXQuc3R5bGUuYmFja2dyb3VuZENvbG9yID0gJ2dyZXknO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHhQb2ludCk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHlQb2ludCk7XG4gICAgICAgICAgICAgICAgICAgIGdhbWVCb2FyZC5yZWNlaXZlQXR0YWNrKHhQb2ludCwgeVBvaW50KTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZ2FtZUJvYXJkLmFsbFNoaXBzU3VuayhzaGlwcykgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdQbGF5ZXIgd29uIScpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHBsYXllci5ib2FyZC5hbGxTaGlwc1N1bmsocGxheWVyLnNoaXBzKSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0NvbXB1dGVyIHdvbiEnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgKHNoaXBUeXBlID09ICdDYXJyaWVyJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgaGl0U2hpcCA9IHNoaXBzLmZpbHRlcihzaGlwID0+IHNoaXAubGVuZ3RoID09IHNoaXBMZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaGl0U2hpcFswXS5oaXQocG9zNSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBwb3M1ICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hpcFR5cGUgPT0gJ0JhdHRsZXNoaXAnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBoaXRTaGlwID0gc2hpcHMuZmlsdGVyKHNoaXAgPT4gc2hpcC5sZW5ndGggPT0gc2hpcExlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBoaXRTaGlwWzBdLmhpdChwb3M0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvczQgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzaGlwVHlwZSA9PSAnRGVzdHJveWVyJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgaGl0U2hpcCA9IHNoaXBzLmZpbHRlcihzaGlwID0+IHNoaXAubGVuZ3RoID09IHNoaXBMZW5ndGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaGl0U2hpcFswXS5oaXQocG9zMyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgcG9zMyArPSAxO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHNoaXBUeXBlID09ICdTdWJtYXJpbmUnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBoaXRTaGlwID0gc2hpcHMuZmlsdGVyKHNoaXAgPT4gc2hpcC5sZW5ndGggPT0gc2hpcExlbmd0aCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBoaXRTaGlwWzFdLmhpdChwb3MyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvczIgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChzaGlwVHlwZSA9PSAnUGF0cm9sYm9hdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGhpdFNoaXAgPSBzaGlwcy5maWx0ZXIoc2hpcCA9PiBzaGlwLmxlbmd0aCA9PSBzaGlwTGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGhpdFNoaXBbMF0uaGl0KHBvczEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgcG9zMSArPSAxO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHBsYXllci50b2dnbGUoKTtcbiAgICAgICAgICAgICAgICAgICAgZW5lbXkudG9nZ2xlKCk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjb29yZGluYXRlcyA9IHBsYXllci5lbmVteU1vdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coY29vcmRpbmF0ZXMpO1xuICAgICAgICAgICAgICAgICAgICBlbmVteUF0dGFjayhwbGF5ZXIsIGVuZW15LCBjb29yZGluYXRlc1swXSwgY29vcmRpbmF0ZXNbMV0pO1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhnYW1lQm9hcmQuZ2FtZUJvYXJkW3hQb2ludF1beVBvaW50XSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gRG8gbm90aGluZ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gRG8gbm90aGluZ1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xufTtcblxuY29uc3QgZW5lbXlBdHRhY2sgPSAocGxheWVyLCBlbmVteSwgeCwgeSkgPT4ge1xuICAgIGxldCBnYW1lQm9hcmQgPSBwbGF5ZXIuYm9hcmQ7XG4gICAgbGV0IHNoaXBzID0gcGxheWVyLnNoaXBzO1xuICAgIGxldCBpc1Nob3QgPSBnYW1lQm9hcmQuZ2FtZUJvYXJkW3hdW3ldLmlzU2hvdDs7XG4gICAgbGV0IGhhc1NoaXAgPSBnYW1lQm9hcmQuZ2FtZUJvYXJkW3hdW3ldLmhhc1NoaXA7XG4gICAgbGV0IHNoaXBMZW5ndGggPSBnYW1lQm9hcmQuZ2FtZUJvYXJkW3hdW3ldLnNoaXBMZW5ndGg7XG4gICAgbGV0IHNoaXBUeXBlID0gZ2FtZUJvYXJkLmdhbWVCb2FyZFt4XVt5XS5zaGlwVHlwZTtcbiAgICBsZXQgcGFuZWw7XG4gICAgaWYgKHggPT09IDApe1xuICAgICAgICBwYW5lbCA9IHk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcGFuZWwgPSAnJyArIHggKyB5O1xuICAgIH1cbiAgICBsZXQgc3F1YXJlRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnYXRrRGl2MScpW3BhbmVsXTsgIFxuICAgIGxldCBwb3M1ID0gMDtcbiAgICBsZXQgcG9zNCA9IDA7XG4gICAgbGV0IHBvczMgPSAwO1xuICAgIGxldCBwb3MyID0gMDtcbiAgICBsZXQgcG9zMSA9IDA7XG5cbiAgICBpZiAoZW5lbXkuaXNBY3RpdmUgPT09IHRydWUpIHtcblxuICAgICAgICBpZiAoaXNTaG90ID09PSBmYWxzZSkge1xuICAgICAgICAgICAgaWYgKGhhc1NoaXAgPT09IHRydWUpe1xuICAgICAgICAgICAgICAgIHNxdWFyZURpdi5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAncmVkJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc3F1YXJlRGl2LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdncmV5JztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGdhbWVCb2FyZC5yZWNlaXZlQXR0YWNrKHgsIHkpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoZ2FtZUJvYXJkLmFsbFNoaXBzU3VuayhzaGlwcykgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQ29tcHV0ZXIgd29uIScpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZW5lbXkuYm9hcmQuYWxsU2hpcHNTdW5rKGVuZW15LnNoaXBzKSA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVc2VyIHdvbiEnKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiAoc2hpcFR5cGUgPT0gJ0NhcnJpZXInKSB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgbGV0IGhpdFNoaXAgPSBzaGlwcy5maWx0ZXIoc2hpcCA9PiBzaGlwLmxlbmd0aCA9PSBzaGlwTGVuZ3RoKTtcbiAgICAgICAgICAgICAgICBoaXRTaGlwWzBdLmhpdChwb3M1KTtcbiAgICAgICAgICAgICAgICBwb3M1ICs9IDE7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHNoaXBUeXBlID09ICdCYXR0bGVzaGlwJykge1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGxldCBoaXRTaGlwID0gc2hpcHMuZmlsdGVyKHNoaXAgPT4gc2hpcC5sZW5ndGggPT0gc2hpcExlbmd0aCk7XG4gICAgICAgICAgICAgICAgaGl0U2hpcFswXS5oaXQocG9zNCk7XG4gICAgICAgICAgICAgICAgcG9zNCArPSAxO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChzaGlwVHlwZSA9PSAnRGVzdHJveWVyJykge1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGxldCBoaXRTaGlwID0gc2hpcHMuZmlsdGVyKHNoaXAgPT4gc2hpcC5sZW5ndGggPT0gc2hpcExlbmd0aCk7XG4gICAgICAgICAgICAgICAgaGl0U2hpcFswXS5oaXQocG9zMyk7XG4gICAgICAgICAgICAgICAgICAgIHBvczMgKz0gMTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hpcFR5cGUgPT0gJ1N1Ym1hcmluZScpIHtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBsZXQgaGl0U2hpcCA9IHNoaXBzLmZpbHRlcihzaGlwID0+IHNoaXAubGVuZ3RoID09IHNoaXBMZW5ndGgpO1xuICAgICAgICAgICAgICAgIGhpdFNoaXBbMV0uaGl0KHBvczIpO1xuICAgICAgICAgICAgICAgIHBvczIgKz0gMTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoc2hpcFR5cGUgPT0gJ1BhdHJvbGJvYXQnKSB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgbGV0IGhpdFNoaXAgPSBzaGlwcy5maWx0ZXIoc2hpcCA9PiBzaGlwLmxlbmd0aCA9PSBzaGlwTGVuZ3RoKTtcbiAgICAgICAgICAgICAgICBoaXRTaGlwWzBdLmhpdChwb3MxKTtcbiAgICAgICAgICAgICAgICBwb3MxICs9IDE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwbGF5ZXIudG9nZ2xlKCk7XG4gICAgICAgICAgICBlbmVteS50b2dnbGUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBjb29yZGluYXRlcyA9IHBsYXllci5lbmVteU1vdmUoKTtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGNvb3JkaW5hdGVzKTtcbiAgICAgICAgICAgIGVuZW15QXR0YWNrKHBsYXllciwgZW5lbXksIGNvb3JkaW5hdGVzWzBdLCBjb29yZGluYXRlc1sxXSk7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBEbyBub3RoaW5nXG4gICAgfTtcbn07XG5cbmNvbnN0IHBsYWNlUGllY2VzID0gKHBsYXllcikgPT4ge1xuXG4gICAgY29uc3Qgb25EcmFnT3ZlciA9IChlKSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gICAgY29uc3Qgb25Ecm9wID0gKGUpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBlLnRhcmdldC5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSAnZ3JlZW4nO1xuICAgICAgICBjb25zb2xlLmxvZyhlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEteS1jb29yZCcpKTtcbiAgICAgICAgY29uc29sZS5sb2coZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLXgtY29vcmQnKSk7XG4gICAgICAgIGxldCB4ID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCdkYXRhLXgtY29vcmQnKTtcbiAgICAgICAgbGV0IHkgPSBlLnRhcmdldC5nZXRBdHRyaWJ1dGUoJ2RhdGEteS1jb29yZCcpO1xuICAgICAgICBsZXQgZGF0YSA9IGUuZGF0YVRyYW5zZmVyLmdldERhdGEoJ3RleHQnKTtcbiAgICAgICAgY29uc29sZS5sb2cocGxheWVyKTtcbiAgICAgICAgaWYgKGRhdGEgPT09ICdDYXJyaWVyJyl7XG4gICAgICAgICAgICBwbGF5ZXIucGxhY2VTaGlwKHBhcnNlSW50KHgpLCBwYXJzZUludCh5KSwgNSwgZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRhdGEgPT09ICdCYXR0bGVzaGlwJyl7XG4gICAgICAgICAgICBwbGF5ZXIucGxhY2VTaGlwKHBhcnNlSW50KHgpLCBwYXJzZUludCh5KSwgNCwgZGF0YSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGRhdGEgPT09ICdEZXN0cm95ZXInKXtcbiAgICAgICAgICAgIHBsYXllci5wbGFjZVNoaXAocGFyc2VJbnQoeCksIHBhcnNlSW50KHkpLCAzLCBkYXRhKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZGF0YSA9PT0gJ1N1Ym1hcmluZScpe1xuICAgICAgICAgICAgcGxheWVyLnBsYWNlU2hpcChwYXJzZUludCh4KSwgcGFyc2VJbnQoeSksIDMsIGRhdGEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChkYXRhID09PSAnUGF0cm9sQm9hdCcpe1xuICAgICAgICAgICAgcGxheWVyLnBsYWNlU2hpcChwYXJzZUludCh4KSwgcGFyc2VJbnQoeSksIDIsIGRhdGEpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGxldCByZXNwb25zZSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2F0a0RpdjEnKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzcG9uc2UubGVuZ3RoOyBpKyspe1xuICAgICAgICByZXNwb25zZVtpXS5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIG9uRHJhZ092ZXIpO1xuICAgICAgICByZXNwb25zZVtpXS5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgb25Ecm9wKTtcbiAgICB9O1xuXG59XG5cbmNvbnN0IGRlUmVuZGVyID0gKCkgPT4ge1xuICAgIGxldCBwYXJlbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NvbnRhaW5lcjFcIik7XG4gICAgd2hpbGUgKHBhcmVudC5maXJzdENoaWxkKSB7XG4gICAgICAgIHBhcmVudC5yZW1vdmVDaGlsZChwYXJlbnQuZmlyc3RDaGlsZCk7XG4gICAgfVxufVxuXG5leHBvcnQgeyBcblxuICAgIHJlbmRlckdCb2FyZCxcbiAgICBhdGtMaXN0ZW5lcixcbiAgICBwbGFjZVBpZWNlcyxcbiAgICBkZVJlbmRlcixcbiB9OyIsImltcG9ydCB7IFBsYXllciB9IGZyb20gJy4vcGxheWVyRmFjdG9yeSc7XG5pbXBvcnQgeyByZW5kZXJHQm9hcmQsIGF0a0xpc3RlbmVyLCBwbGFjZVBpZWNlcywgZGVSZW5kZXIgfSBmcm9tICcuL3JlbmRlcic7XG5cbmNvbnN0IGdhbWUgPSAoKSA9PiB7XG5cbiAgICBjb25zdCBzdGFydEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzdGFydEJ0bicpO1xuXG4gICAgLy8gbGV0IGRhdGE7XG4gICAgLy8gbGV0IGNhcnJpZXJYO1xuICAgIC8vIGxldCBjYXJyaWVyWTtcblxuICAgIGNvbnN0IG9uRHJhZ1N0YXJ0ID0gKGUpID0+IHtcbiAgICAgICAgZS5kYXRhVHJhbnNmZXIuc2V0RGF0YSgndGV4dC9wbGFpbicsIGUudGFyZ2V0LmlkKTtcbiAgICAgICAgZS5jdXJyZW50VGFyZ2V0LnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICdncmVlbic7XG4gICAgfVxuICAgIFxuXG4gICAgY29uc3QgY2FycmllckRyYWcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjQ2FycmllcicpO1xuICAgIGNhcnJpZXJEcmFnLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsIG9uRHJhZ1N0YXJ0KTtcbiAgICBjb25zdCBiYXR0bGVEcmFnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI0JhdHRsZXNoaXAnKTtcbiAgICBiYXR0bGVEcmFnLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsIG9uRHJhZ1N0YXJ0KTtcbiAgICBjb25zdCBkZXN0ckRyYWcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjRGVzdHJveWVyJyk7XG4gICAgZGVzdHJEcmFnLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsIG9uRHJhZ1N0YXJ0KTtcbiAgICBjb25zdCBzdWJEcmFnID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI1N1Ym1hcmluZScpO1xuICAgIHN1YkRyYWcuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0Jywgb25EcmFnU3RhcnQpO1xuICAgIGNvbnN0IHBhdHJvbERyYWcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjUGF0cm9sQm9hdCcpO1xuICAgIHBhdHJvbERyYWcuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ3N0YXJ0Jywgb25EcmFnU3RhcnQpO1xuXG4gICAgLy9jcmVhdGUgcGxheWVyIGFuZCBjb21wdXRlciBwbGF5ZXJcbiAgICAvL3BvcHVsYXRlIGdhbWVib2FyZHMgZm9yIGJvdGggcGxheWVyc1xuXG4gICAgY29uc3QgcGxheWVyQXJyID0gW1xuICAgICAgICBQbGF5ZXIoXCJwbGF5ZXIxXCIsIHRydWUpLFxuICAgICAgICBQbGF5ZXIoXCJjb21wdXRlclwiLCBmYWxzZSlcbiAgICBdO1xuXG4gICAgcmVuZGVyR0JvYXJkKHBsYXllckFyclswXS5ib2FyZC5nYW1lQm9hcmQsIDEpO1xuICAgIHBsYWNlUGllY2VzKHBsYXllckFyclswXS5ib2FyZCk7XG5cbiAgICBzdGFydEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKCl7XG4gICAgICAgIGRlUmVuZGVyKCk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKGNhcnJpZXJYKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coY2FycmllclkpO1xuICAgICAgICAvLyBwbGF5ZXJBcnJbMF0uYm9hcmQucGxhY2VTaGlwKHBhcnNlSW50KGNhcnJpZXJYKSwgcGFyc2VJbnQoY2FycmllclkpLCA1LCAnQ2FycmllcicpO1xuICAgICAgICAvLyBwbGF5ZXJBcnJbMF0uYm9hcmQucGxhY2VTaGlwKDgsIDAsIDQsICdCYXR0bGVzaGlwJyk7XG4gICAgICAgIC8vIHBsYXllckFyclswXS5ib2FyZC5wbGFjZVNoaXAoNiwgNywgMywgJ0Rlc3Ryb3llcicpO1xuICAgICAgICAvLyBwbGF5ZXJBcnJbMF0uYm9hcmQucGxhY2VTaGlwKDUsIDEsIDMsICdTdWJtYXJpbmUnKTtcbiAgICAgICAgLy8gcGxheWVyQXJyWzBdLmJvYXJkLnBsYWNlU2hpcCgxLCA3LCAyLCAnUGF0cm9sYm9hdCcpO1xuICAgICAgICBjb25zb2xlLmxvZyhwbGF5ZXJBcnJbMF0uYm9hcmQuZ2FtZUJvYXJkKTtcbiAgICAgICAgcmVuZGVyR0JvYXJkKHBsYXllckFyclswXS5ib2FyZC5nYW1lQm9hcmQsIDEpO1xuICAgICAgICAvLyBwbGF5ZXJBcnJbMV0uYm9hcmQucGxhY2VTaGlwKDgsIDEsIDUsICdDYXJyaWVyJyk7XG4gICAgICAgIC8vIHBsYXllckFyclsxXS5ib2FyZC5wbGFjZVNoaXAoMywgNSwgNCwgJ0JhdHRsZXNoaXAnKTtcbiAgICAgICAgLy8gcGxheWVyQXJyWzFdLmJvYXJkLnBsYWNlU2hpcCg2LCAzLCAzLCAnRGVzdHJveWVyJyk7XG4gICAgICAgIC8vIHBsYXllckFyclsxXS5ib2FyZC5wbGFjZVNoaXAoMSwgMSwgMywgJ1N1Ym1hcmluZScpO1xuICAgICAgICAvLyBwbGF5ZXJBcnJbMV0uYm9hcmQucGxhY2VTaGlwKDAsIDYsIDIsICdQYXRyb2xib2F0Jyk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHBsYXllckFyclsxXS5ib2FyZC5nYW1lQm9hcmQpO1xuICAgICAgICByZW5kZXJHQm9hcmQocGxheWVyQXJyWzFdLmJvYXJkLmdhbWVCb2FyZCwgMik7XG4gICAgICAgIGF0a0xpc3RlbmVyKHBsYXllckFyclswXSwgcGxheWVyQXJyWzFdLCAyKTtcbiAgICAgICAgYXRrTGlzdGVuZXIocGxheWVyQXJyWzFdLCBwbGF5ZXJBcnJbMF0sIDIpO1xuICAgIH0pO1xuXG59O1xuXG5leHBvcnQgeyBnYW1lIH07IiwiaW1wb3J0IHsgZ2FtZSB9IGZyb20gJy4vZ2FtZSc7XG5cbmdhbWUoKTsiXSwibmFtZXMiOlsic2hpcEZhY3RvcnkiLCJsZW5ndGgiLCJzaGlwIiwiaGl0IiwicG9zIiwiaXNTdW5rIiwiY291bnQiLCJzdW5rIiwiZm9yRWFjaCIsIml0ZW0iLCJQbGF5ZXIiLCJuYW1lIiwiaXNBY3RpdmUiLCJjYXJyaWVyIiwiYmF0dGxlc2hpcCIsImRlc3Ryb3llciIsInN1Ym1hcmluZSIsInBhdHJvbEJvYXQiLCJzdGF0ZSIsInRvZ2dsZSIsImJvYXJkIiwiZ2FtZUJvYXJkIiwiaSIsImoiLCJoYXNTaGlwIiwiaXNTaG90Iiwic2hpcExlbmd0aCIsInNoaXBUeXBlIiwieFBvaW50IiwieVBvaW50IiwicGxhY2VTaGlwIiwieCIsInkiLCJjb25zb2xlIiwibG9nIiwicmVjZWl2ZUF0dGFjayIsImFsbFNoaXBzU3VuayIsImFyciIsImZpbHRlciIsInNoaXBzIiwiZ2FtZUJvYXJkRmFjdG9yeSIsImVuZW15TW92ZSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInJlbmRlckdCb2FyZCIsIm51bSIsImNvbnRhaW5lciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInJvdzEiLCJjcmVhdGVFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwicm93MiIsInJvdzMiLCJyb3c0Iiwicm93NSIsInJvdzYiLCJyb3c3Iiwicm93OCIsInJvdzkiLCJyb3cxMCIsImluZGV4Iiwic3ViaXRlbSIsInN1YmluZGV4Iiwic3F1YXJlRGl2IiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJnZXRBdHRyaWJ1dGUiLCJhcHBlbmRDaGlsZCIsImF0a0xpc3RlbmVyIiwicGxheWVyIiwiZW5lbXkiLCJyZXNwb25zZSIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJwb3M1IiwicG9zNCIsInBvczMiLCJwb3MyIiwicG9zMSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwidGFyZ2V0Iiwic3R5bGUiLCJiYWNrZ3JvdW5kQ29sb3IiLCJjb29yZGluYXRlcyIsImVuZW15QXR0YWNrIiwicGFuZWwiLCJzdGFydEJ0biIsIm9uRHJhZ1N0YXJ0IiwiZGF0YVRyYW5zZmVyIiwic2V0RGF0YSIsImlkIiwiY3VycmVudFRhcmdldCIsInBsYXllckFyciIsIm9uRHJhZ092ZXIiLCJwcmV2ZW50RGVmYXVsdCIsIm9uRHJvcCIsImRhdGEiLCJnZXREYXRhIiwicGFyc2VJbnQiLCJwbGFjZVBpZWNlcyIsInBhcmVudCIsImZpcnN0Q2hpbGQiLCJyZW1vdmVDaGlsZCIsImRlUmVuZGVyIiwiZ2FtZSJdLCJzb3VyY2VSb290IjoiIn0=